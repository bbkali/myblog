clone_depth: 5
environment:
    priv_key:
        secure: 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
    access_token:
        secure: s4WaF6gBPMTY/INuFShyWzidiWytUJgZ59LZ02oCl4CgjrP8KrPLdX1DuZeRJ624
install:
    - ps: $fileContent = "-----BEGIN RSA PRIVATE KEY-----`n"
    - ps: $fileContent += $env:priv_key.Replace(' ', "`n")
    - ps: $fileContent += "`n-----END RSA PRIVATE KEY-----`n"
    - ps: Set-Content $env:userprofile\.ssh\id_rsa $fileContent
    - git submodule update --init --recursive
    - node --version
    - npm --version
    - npm install
    - npm install -g hexo
    - npm install hexo-cli -g
    - npm install hexo-renderer-pug --save
    - npm install hexo-deployer-git --save
    - npm install hexo-server --save
    - npm install hexo-renderer-jade --save
    - npm install hexo-renderer-stylus --save
    - npm install hexo-algolia --save
build_script:
    - hexo generate
artifacts:
    - path: public
on_success:
    - git config --global credential.helper store
    - ps: Add-Content "$env:USERPROFILE\.git-credentials" "https://$($env:access_token):x-oauth-basic@github.com`n"
    - git config --global user.email "%GIT_USER_EMAIL%"
    - git config --global user.name "%GIT_USER_NAME%"
    - git clone --depth 5 -q --branch=%TARGET_BRANCH% %STATIC_SITE_REPO% %TEMP%\static-site
    - cd %TEMP%\static-site
    - del * /f /q
    - for /d %%p IN (*) do rmdir "%%p" /s /q
    - SETLOCAL EnableDelayedExpansion & robocopy "%APPVEYOR_BUILD_FOLDER%\public" "%TEMP%\static-site" /e & IF !ERRORLEVEL! EQU 1 (exit 0) ELSE (IF !ERRORLEVEL! EQU 3 (exit 0) ELSE (exit 1))
    - git add -A
    - if "%APPVEYOR_REPO_BRANCH%"=="master" if not defined APPVEYOR_PULL_REQUEST_NUMBER (git diff --quiet --exit-code --cached || git commit -m "Update Static Site" && git push origin %TARGET_BRANCH% && appveyor AddMessage "Static Site Updated")